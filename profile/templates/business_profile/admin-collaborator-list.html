{% extends 'business_profile/admin-base.html' %}

{% load static from staticfiles %}
{% load breadcrumbs from directory_components %}

{% block breadcrumbs %}
    {% breadcrumbs 'Collaborators' %}
        <a href="{{ services_urls.great_domestic }}">great.gov.uk</a>
        <a href="{% url 'business-profile' %}">Business profile</a>
		<a href="{% url 'business-profile-admin-invite-collaborator' %}">Profile settings</a>
    {% endbreadcrumbs %}
{% endblock %}


{% block inner_content %}
  <h2 class="heading-large margin-top-0">Collaborators</h2>
  <table>
    <thead>
      <tr>
        <th class="border-light-grey padding-top-15 padding-bottom-15" scope="col">People</th>
        <th class="border-light-grey padding-top-15 padding-bottom-15" scope="col">Role</th>
        <th class="border-light-grey padding-top-15 padding-bottom-15 numeric" scope="col">Action</th>
      </tr>
    </thead>
    <tbody>
      {% for collaborator in collaborators %}
          <tr>
            <th class="border-white padding-top-15 padding-bottom-10" scope="row">{{ collaborator.name|default:collaborator.company_email }}</th>
            <td class="border-white padding-top-15 padding-bottom-10">{{ collaborator.role|title }}</td>
            {% if collaborator.sso_id == request.user.id %}
                <td class="border-white padding-top-15 padding-bottom-10 numeric">
                    <a href="{% url 'business-profile-admin-disconnect' %}" class="link">Remove profile from my account</a>
                </td>
            {% else %}
              <td class="border-white padding-top-15 padding-bottom-10 numeric">
                  <a href="{% url 'business-profile-admin-collaborator-edit' sso_id=collaborator.sso_id %}" class="link">Edit</a>
              </td>
            {% endif %}
          </tr>
      {% endfor %}
    </tbody>
  </table>
<h2 class="heading-large margin-top-0">Editor Requests</h2>
  <table>
    <thead>
      <tr>
        <th class="border-light-grey padding-top-15 padding-bottom-15" scope="col">People</th>
        <th class="border-light-grey padding-top-15 padding-bottom-15" scope="col">Job Role</th>
		<th class="border-light-grey padding-top-15 padding-bottom-15" scope="col">Request</th>
        <th class="border-light-grey padding-top-15 padding-bottom-15 numeric" scope="col">Actions</th>
      </tr>
    </thead>
	  {% if editor_requests %}
		<tbody>
		  {% for request in collaboration_requests %}
			  <tr>
				<th class="border-white padding-top-15 padding-bottom-10" scope="row">{{ request.name }}</th>
				<td class="border-white padding-top-15 padding-bottom-10">{{ request.role|title }}</td>
				  <td class="border-white padding-top-15 padding-bottom-10 numeric">Request to become administrator</td>
					  <td class="border-white padding-top-15 padding-bottom-10 numeric">
						<form action="{% url 'business-profile-collaboration-request-manage' %}" method="post" enctype="multipart/form-data" class="no-default-margin">
			            	<input type="hidden" name="request_key" value="{{ request.uuid }}" />
							<input type="hidden" name="action" value="accept" />
							<input type="submit" class="link background-white numeric" value="Approve">
						</form>
				    	<form action="{% url 'business-profile-collaboration-request-manage' %}" method="post" enctype="multipart/form-data" class="no-default-margin">
			            	<input type="hidden" name="request_key" value="{{ request.uuid }}" />
							<input type="hidden" name="action" value="delete" />
				    	<input type="submit" class="link background-white numeric" value="Delete">
			        </form>
				  </td>
			  </tr>
		  {% endfor %}
    	</tbody>
	  {% else %}
	  		<tr>
		    <th class="border-white padding-top-15 padding-bottom-10" scope="row">You currently have no requests.</th>
		</tr>
	  {% endif %}
  </table>
{% endblock %}
